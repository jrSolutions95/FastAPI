stages:
  - lint
  - test_unit
  - test_integration

lint:
  stage: lint
  image: python:3.10
  script:
    - pip install black flake8
    - flake8 .
    - black --check .

unit_tests:
  stage: test_unit
  image: python:3.10
  script:
    - pip install -r requirements.txt
    - pip install pytest pytest-cov pytest-asyncio
    - pytest tests/test_unit_validators.py --cov=main --cov-report=xml

integration_tests:
  stage: test_integration
  image: python:3.10
  script:
    - pip install -r requirements.txt
    - pip install pytest pytest-cov pytest-asyncio
    - pytest tests/test_integration_routes.py test_main.py --cov=main --cov-append --cov-report=term
